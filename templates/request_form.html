{%extends 'base.html'%}
{% load static %}
{%block title%} New Request {%endblock title%}
{%block head%}
    <link rel="stylesheet" href="{% static 'styles/newRequest.css' %}">
    <style>
        .hidden { display: none; }
    </style>
{%endblock head%}
{%block content%}
<div class="container mt-5">
    <div class="card">
        <div class="card-header text-center">
            <h3>Request Dokumen</h3>
        </div>
        <div class="card-body">
            <form id="requestForm">
                <!-- Step 1: Pilih Jenis Dokumen -->
                <div id="step1">
                    <h5>Step 1: Pilih Jenis Dokumen</h5>
                    <select class="form-control" id="documentType" required>
                        <option value="">Pilih Dokumen</option>
                        <option value="FP">Funding Proposal</option>
                        <option value="IL">Introduction Letter</option>
                        <option value="AL">Assignment Letter</option>
                        <option value="RL">Recommendation Letter</option>
                        <option value="AR">Access Request</option>
                        <option value="OT">Other Document</option>
                    </select>
                    <button type="button" class="btn btn-primary mt-3 next-btn">Next</button>
                </div>

                <!-- Step 2: Isi Title, Deskripsi, dan Prioritas -->
                <div id="step2" class="hidden">
                    <h5>Step 2: Isi Detail Dokumen</h5>
                    <input type="text" class="form-control" id="title" placeholder="Judul" required>
                    <textarea class="form-control mt-2" id="description" placeholder="Deskripsi" required></textarea>
                    <select class="form-control mt-2" id="priority" required>
                        <option value="Medium">Medium</option>
                        <option value="High">High</option>
                        <option value="Low">Low</option>
                    </select>
                    <button type="button" class="btn btn-secondary mt-3 prev-btn">Back</button>
                    <button type="button" class="btn btn-primary mt-3 next-btn">Next</button>
                </div>

                <!-- Step 3: Deadline, Notes, Upload File -->
                <div id="step3" class="hidden">
                    <h5>Step 3: Opsi Tambahan</h5>
                    <input type="date" class="form-control" id="deadline">
                    <textarea class="form-control mt-2" id="notes" placeholder="Catatan tambahan"></textarea>
                    <input type="file" class="form-control mt-2" id="fileUpload">
                    <button type="button" class="btn btn-secondary mt-3 prev-btn">Back</button>
                    <button type="button" class="btn btn-primary mt-3 next-btn">Next</button>
                </div>

                <!-- Step 4: Review Data -->
                <div id="step4" class="hidden">
                    <h5>Step 4: Review Request</h5>
                    <ul class="list-group">
                        <li class="list-group-item"><strong>Jenis Dokumen:</strong> <span id="reviewType"></span></li>
                        <li class="list-group-item"><strong>Judul:</strong> <span id="reviewTitle"></span></li>
                        <li class="list-group-item"><strong>Deskripsi:</strong> <span id="reviewDescription"></span></li>
                        <li class="list-group-item"><strong>Prioritas:</strong> <span id="reviewPriority"></span></li>
                        <li class="list-group-item"><strong>Deadline:</strong> <span id="reviewDeadline"></span></li>
                        <li class="list-group-item"><strong>Catatan:</strong> <span id="reviewNotes"></span></li>
                        <li class="list-group-item"><strong>File:</strong> <span id="reviewFile"></span></li>
                    </ul>
                    <button type="button" class="btn btn-secondary mt-3 prev-btn">Back</button>
                    <button type="submit" class="btn btn-success mt-3">Submit</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    let currentStep = 1;
    const steps = document.querySelectorAll("form > div");

    document.querySelectorAll(".next-btn").forEach(btn => {
        btn.addEventListener("click", () => {
            if (currentStep < 4) {
                steps[currentStep - 1].classList.add("hidden");
                steps[currentStep].classList.remove("hidden");
                currentStep++;
            }
        });
    });

    document.querySelectorAll(".prev-btn").forEach(btn => {
        btn.addEventListener("click", () => {
            if (currentStep > 1) {
                steps[currentStep - 1].classList.add("hidden");
                steps[currentStep - 2].classList.remove("hidden");
                currentStep--;
            }
        });
    });

    document.getElementById("requestForm").addEventListener("submit", (e) => {
        e.preventDefault();
        alert("Request berhasil dikirim!");
        window.location.href = "success.html";
    });

    document.querySelectorAll(".next-btn")[2].addEventListener("click", () => {
        document.getElementById("reviewType").textContent = document.getElementById("documentType").value;
        document.getElementById("reviewTitle").textContent = document.getElementById("title").value;
        document.getElementById("reviewDescription").textContent = document.getElementById("description").value;
        document.getElementById("reviewPriority").textContent = document.getElementById("priority").value;
        document.getElementById("reviewDeadline").textContent = document.getElementById("deadline").value || "Tidak Ada";
        document.getElementById("reviewNotes").textContent = document.getElementById("notes").value || "Tidak Ada";
        document.getElementById("reviewFile").textContent = document.getElementById("fileUpload").files[0]?.name || "Tidak Ada";
    });
</script>
{%endblock content%}